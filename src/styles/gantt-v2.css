/* Cronograma de Gantt v2 - Sticky Columns & Responsive Layout */

:root {
  /* Sidebar width - consistent across app */
  --sidebar-width: 240px;
  
  /* Column widths - fixed to prevent overlapping */
  --gantt-col-no: 72px;           /* No. */
  --gantt-col-mayor: 280px;       /* Mayor */
  --gantt-col-importe: 180px;     /* Importe */
  --gantt-col-pct: 120px;         /* % */
  
  /* Mobile column widths - smaller for mobile */
  --gantt-col-no-mobile: 48px;
  --gantt-col-mayor-mobile: 180px;
  --gantt-col-importe-mobile: 120px;
  --gantt-col-pct-mobile: 80px;
  
  /* Tablet column widths - medium for tablet */
  --gantt-col-no-tablet: 60px;
  --gantt-col-mayor-tablet: 220px;
  --gantt-col-importe-tablet: 140px;
  --gantt-col-pct-tablet: 100px;
}

/* Sticky Header Classes - Higher z-index to avoid conflicts */
.gantt-header {
  position: sticky;
  top: 0;
  z-index: 60 !important;
  background: hsl(var(--background)) !important;
  border-bottom: 1px solid hsl(var(--border));
}

/* Sticky Columns - Desktop - High priority with !important */
.gantt-freeze-no {
  position: sticky !important;
  left: 0 !important;
  z-index: 50 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border));
}

.gantt-freeze-mayor {
  position: sticky !important;
  left: var(--gantt-col-no) !important;
  z-index: 50 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border));
}

.gantt-freeze-importe {
  position: sticky !important;
  left: calc(var(--gantt-col-no) + var(--gantt-col-mayor)) !important;
  z-index: 50 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border));
}

.gantt-freeze-pct {
  position: sticky !important;
  left: calc(var(--gantt-col-no) + var(--gantt-col-mayor) + var(--gantt-col-importe)) !important;
  z-index: 50 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border));
}

/* Column width enforcement */
.col-no {
  width: var(--gantt-col-no);
  min-width: var(--gantt-col-no);
  max-width: var(--gantt-col-no);
}

.col-mayor {
  width: var(--gantt-col-mayor);
  min-width: var(--gantt-col-mayor);
  max-width: var(--gantt-col-mayor);
}

.col-importe {
  width: var(--gantt-col-importe);
  min-width: var(--gantt-col-importe);
  max-width: var(--gantt-col-importe);
}

.col-pct {
  width: var(--gantt-col-pct);
  min-width: var(--gantt-col-pct);
  max-width: var(--gantt-col-pct);
}

/* Table layout fixes - Force horizontal scroll */
.gantt-table {
  table-layout: fixed !important;
  min-width: calc(var(--gantt-col-no) + var(--gantt-col-mayor) + var(--gantt-col-importe) + var(--gantt-col-pct) + 1200px) !important;
  width: max-content !important;
}

/* Sticky toolbar */
.gantt-toolbar {
  position: sticky;
  top: 0;
  z-index: 45;
  background: hsl(var(--background));
  border-bottom: 1px solid hsl(var(--border));
}

/* Gantt container width calculations */
.gantt-container {
  width: calc(100vw - var(--sidebar-width));
  max-width: calc(100vw - var(--sidebar-width));
  overflow-x: hidden;
}

/* Mobile Responsive - Card layout for small screens */
@media (max-width: 767px) {
  :root {
    --sidebar-width: 0px; /* Mobile typically has no visible sidebar */
    --gantt-col-no: var(--gantt-col-no-mobile);
    --gantt-col-mayor: var(--gantt-col-mayor-mobile);
    --gantt-col-importe: var(--gantt-col-importe-mobile);
    --gantt-col-pct: var(--gantt-col-pct-mobile);
  }
  
  .gantt-container {
    width: 100vw;
    max-width: 100vw;
    padding-left: 8px;
    padding-right: 8px;
  }
  
  .gantt-freeze-mayor {
    left: var(--gantt-col-no-mobile) !important;
  }
  
  .gantt-freeze-importe {
    left: calc(var(--gantt-col-no-mobile) + var(--gantt-col-mayor-mobile)) !important;
  }
  
  .gantt-freeze-pct {
    left: calc(var(--gantt-col-no-mobile) + var(--gantt-col-mayor-mobile) + var(--gantt-col-importe-mobile)) !important;
  }
}

/* Tablet Responsive */
@media (min-width: 768px) and (max-width: 1023px) {
  :root {
    --sidebar-width: 240px; /* Tablet has sidebar */
    --gantt-col-no: var(--gantt-col-no-tablet);
    --gantt-col-mayor: var(--gantt-col-mayor-tablet);
    --gantt-col-importe: var(--gantt-col-importe-tablet);
    --gantt-col-pct: var(--gantt-col-pct-tablet);
  }
  
  .gantt-container {
    width: calc(100vw - var(--sidebar-width));
    max-width: calc(100vw - var(--sidebar-width));
  }
  
  .gantt-table {
    font-size: 0.875rem; /* text-sm */
  }
  
  .gantt-freeze-mayor {
    left: var(--gantt-col-no-tablet) !important;
  }
  
  .gantt-freeze-importe {
    left: calc(var(--gantt-col-no-tablet) + var(--gantt-col-mayor-tablet)) !important;
  }
  
  .gantt-freeze-pct {
    left: calc(var(--gantt-col-no-tablet) + var(--gantt-col-mayor-tablet) + var(--gantt-col-importe-tablet)) !important;
  }
}

/* Desktop */
@media (min-width: 1024px) {
  :root {
    --sidebar-width: 240px; /* Desktop has full sidebar */
  }
  
  .gantt-container {
    width: calc(100vw - var(--sidebar-width));
    max-width: calc(100vw - var(--sidebar-width));
  }
  
  .gantt-table {
    font-size: 1rem; /* text-base */
  }
}

/* Scroll optimizations */
.gantt-scroll-container {
  overflow-x: auto;
  overflow-y: visible;
  scroll-behavior: smooth;
  position: relative;
  width: 100%;
}

/* Ensure month columns have minimum width to force horizontal scroll */
.gantt-month-col {
  min-width: 120px;
  width: 120px;
}

/* Month columns grid for mobile scroll snapping */
@media (max-width: 767px) {
  .gantt-scroll-container {
    scroll-snap-type: x mandatory;
  }
  
  .gantt-month-column {
    scroll-snap-align: start;
  }
}

/* Background fixes for sticky cells */
.gantt-freeze-no.bg-muted\/50 {
  background: hsl(var(--muted) / 0.5) !important;
}

.gantt-freeze-mayor.bg-muted\/50 {
  background: hsl(var(--muted) / 0.5) !important;
}

.gantt-freeze-importe.bg-muted\/50 {
  background: hsl(var(--muted) / 0.5) !important;
}

.gantt-freeze-pct.bg-muted\/50 {
  background: hsl(var(--muted) / 0.5) !important;
}

.gantt-freeze-no.bg-red-50\/50 {
  background: hsl(var(--destructive) / 0.1) !important;
}

.gantt-freeze-mayor.bg-red-50\/50 {
  background: hsl(var(--destructive) / 0.1) !important;
}

.gantt-freeze-importe.bg-red-50\/50 {
  background: hsl(var(--destructive) / 0.1) !important;
}

.gantt-freeze-pct.bg-red-50\/50 {
  background: hsl(var(--destructive) / 0.1) !important;
}

.gantt-freeze-no.bg-primary\/10 {
  background: hsl(var(--primary) / 0.1) !important;
}

.gantt-freeze-mayor.bg-primary\/10 {
  background: hsl(var(--primary) / 0.1) !important;
}

.gantt-freeze-importe.bg-primary\/10 {
  background: hsl(var(--primary) / 0.1) !important;
}

.gantt-freeze-pct.bg-primary\/10 {
  background: hsl(var(--primary) / 0.1) !important;
}