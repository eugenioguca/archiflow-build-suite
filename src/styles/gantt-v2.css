/* Cronograma de Gantt v2 - Sticky Columns & Responsive Layout */

:root {
  /* Sidebar width - consistent across app */
  --sidebar-width: 240px;
  
  /* Column widths - fixed to prevent overlapping */
  --gantt-col-actions: 100px;     /* Acciones */
  --gantt-col-no: 72px;           /* No. */
  --gantt-col-mayor: 280px;       /* Mayor */
  --gantt-col-importe: 180px;     /* Importe */
  --gantt-col-pct: 120px;         /* % */
  
  /* Mobile column widths - smaller for mobile */
  --gantt-col-actions-mobile: 80px;
  --gantt-col-no-mobile: 48px;
  --gantt-col-mayor-mobile: 180px;
  --gantt-col-importe-mobile: 120px;
  --gantt-col-pct-mobile: 80px;
  
  /* Tablet column widths - medium for tablet */
  --gantt-col-actions-tablet: 90px;
  --gantt-col-no-tablet: 60px;
  --gantt-col-mayor-tablet: 220px;
  --gantt-col-importe-tablet: 140px;
  --gantt-col-pct-tablet: 100px;
}

/* CRITICAL: Scroll container setup - MUST be configured correctly for sticky to work */
.gantt-scroll-container {
  position: relative !important;
  overflow-x: auto !important;
  overflow-y: visible !important;
  width: 100% !important;
  max-width: 100% !important;
}

/* Sticky Header - Maximum priority with table selector */
table.gantt-table .gantt-header {
  position: sticky !important;
  top: 0 !important;
  z-index: 100 !important;
  background: hsl(var(--background)) !important;
}

/* ULTRA HIGH PRIORITY STICKY COLUMNS with table context */
table.gantt-table th.gantt-freeze-actions,
table.gantt-table td.gantt-freeze-actions {
  position: sticky !important;
  left: 0 !important;
  z-index: 90 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border)) !important;
}

table.gantt-table th.gantt-freeze-no,
table.gantt-table td.gantt-freeze-no {
  position: sticky !important;
  left: var(--gantt-col-actions) !important;
  z-index: 90 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border)) !important;
}

table.gantt-table th.gantt-freeze-mayor,
table.gantt-table td.gantt-freeze-mayor {
  position: sticky !important;
  left: calc(var(--gantt-col-actions) + var(--gantt-col-no)) !important;
  z-index: 90 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border)) !important;
}

table.gantt-table th.gantt-freeze-importe,
table.gantt-table td.gantt-freeze-importe {
  position: sticky !important;
  left: calc(var(--gantt-col-actions) + var(--gantt-col-no) + var(--gantt-col-mayor)) !important;
  z-index: 90 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border)) !important;
}

table.gantt-table th.gantt-freeze-pct,
table.gantt-table td.gantt-freeze-pct {
  position: sticky !important;
  left: calc(var(--gantt-col-actions) + var(--gantt-col-no) + var(--gantt-col-mayor) + var(--gantt-col-importe)) !important;
  z-index: 90 !important;
  background: hsl(var(--background)) !important;
  border-right: 1px solid hsl(var(--border)) !important;
}

/* Column width enforcement */
.col-actions {
  width: var(--gantt-col-actions);
  min-width: var(--gantt-col-actions);
  max-width: var(--gantt-col-actions);
}

.col-no {
  width: var(--gantt-col-no);
  min-width: var(--gantt-col-no);
  max-width: var(--gantt-col-no);
}

.col-mayor {
  width: var(--gantt-col-mayor);
  min-width: var(--gantt-col-mayor);
  max-width: var(--gantt-col-mayor);
}

.col-importe {
  width: var(--gantt-col-importe);
  min-width: var(--gantt-col-importe);
  max-width: var(--gantt-col-importe);
}

.col-pct {
  width: var(--gantt-col-pct);
  min-width: var(--gantt-col-pct);
  max-width: var(--gantt-col-pct);
}

/* Table layout - Force horizontal scroll and proper widths */
table.gantt-table {
  table-layout: fixed !important;
  min-width: calc(var(--gantt-col-actions) + var(--gantt-col-no) + var(--gantt-col-mayor) + var(--gantt-col-importe) + var(--gantt-col-pct) + 1400px) !important;
  width: max-content !important;
  border-collapse: separate !important;
  border-spacing: 0 !important;
}

/* Sticky toolbar */
.gantt-toolbar {
  position: sticky;
  top: 0;
  z-index: 45;
  background: hsl(var(--background));
  border-bottom: 1px solid hsl(var(--border));
}

/* Gantt container width calculations */
.gantt-container {
  width: calc(100vw - var(--sidebar-width));
  max-width: calc(100vw - var(--sidebar-width));
  overflow-x: hidden;
}

/* Ensure month columns have minimum width to force horizontal scroll */
.gantt-month-col {
  min-width: 120px;
  width: 120px;
}

/* Mobile Responsive - Card layout for small screens */
@media (max-width: 767px) {
  :root {
    --sidebar-width: 0px; /* Mobile typically has no visible sidebar */
    --gantt-col-actions: var(--gantt-col-actions-mobile);
    --gantt-col-no: var(--gantt-col-no-mobile);
    --gantt-col-mayor: var(--gantt-col-mayor-mobile);
    --gantt-col-importe: var(--gantt-col-importe-mobile);
    --gantt-col-pct: var(--gantt-col-pct-mobile);
  }
  
  .gantt-container {
    width: 100vw;
    max-width: 100vw;
    padding-left: 8px;
    padding-right: 8px;
  }
  
  table.gantt-table th.gantt-freeze-no,
  table.gantt-table td.gantt-freeze-no {
    left: var(--gantt-col-actions-mobile) !important;
  }
  
  table.gantt-table th.gantt-freeze-mayor,
  table.gantt-table td.gantt-freeze-mayor {
    left: calc(var(--gantt-col-actions-mobile) + var(--gantt-col-no-mobile)) !important;
  }
  
  table.gantt-table th.gantt-freeze-importe,
  table.gantt-table td.gantt-freeze-importe {
    left: calc(var(--gantt-col-actions-mobile) + var(--gantt-col-no-mobile) + var(--gantt-col-mayor-mobile)) !important;
  }
  
  table.gantt-table th.gantt-freeze-pct,
  table.gantt-table td.gantt-freeze-pct {
    left: calc(var(--gantt-col-actions-mobile) + var(--gantt-col-no-mobile) + var(--gantt-col-mayor-mobile) + var(--gantt-col-importe-mobile)) !important;
  }
  
  /* Month columns grid for mobile scroll snapping */
  .gantt-scroll-container {
    scroll-snap-type: x mandatory;
  }
  
  .gantt-month-column {
    scroll-snap-align: start;
  }
}

/* Tablet Responsive */
@media (min-width: 768px) and (max-width: 1023px) {
  :root {
    --sidebar-width: 240px; /* Tablet has sidebar */
    --gantt-col-actions: var(--gantt-col-actions-tablet);
    --gantt-col-no: var(--gantt-col-no-tablet);
    --gantt-col-mayor: var(--gantt-col-mayor-tablet);
    --gantt-col-importe: var(--gantt-col-importe-tablet);
    --gantt-col-pct: var(--gantt-col-pct-tablet);
  }
  
  .gantt-container {
    width: calc(100vw - var(--sidebar-width));
    max-width: calc(100vw - var(--sidebar-width));
  }
  
  .gantt-table {
    font-size: 0.875rem; /* text-sm */
  }
  
  table.gantt-table th.gantt-freeze-no,
  table.gantt-table td.gantt-freeze-no {
    left: var(--gantt-col-actions-tablet) !important;
  }
  
  table.gantt-table th.gantt-freeze-mayor,
  table.gantt-table td.gantt-freeze-mayor {
    left: calc(var(--gantt-col-actions-tablet) + var(--gantt-col-no-tablet)) !important;
  }
  
  table.gantt-table th.gantt-freeze-importe,
  table.gantt-table td.gantt-freeze-importe {
    left: calc(var(--gantt-col-actions-tablet) + var(--gantt-col-no-tablet) + var(--gantt-col-mayor-tablet)) !important;
  }
  
  table.gantt-table th.gantt-freeze-pct,
  table.gantt-table td.gantt-freeze-pct {
    left: calc(var(--gantt-col-actions-tablet) + var(--gantt-col-no-tablet) + var(--gantt-col-mayor-tablet) + var(--gantt-col-importe-tablet)) !important;
  }
}

/* Desktop */
@media (min-width: 1024px) {
  :root {
    --sidebar-width: 240px; /* Desktop has full sidebar */
  }
  
  .gantt-container {
    width: calc(100vw - var(--sidebar-width));
    max-width: calc(100vw - var(--sidebar-width));
  }
  
  .gantt-table {
    font-size: 1rem; /* text-base */
  }
}

/* Scroll optimizations */
.gantt-scroll-container {
  overflow-x: auto;
  overflow-y: visible;
  scroll-behavior: smooth;
  position: relative;
  width: 100%;
}

/* Special row backgrounds for sticky cells - ULTRA HIGH PRIORITY */
table.gantt-table tr.bg-muted\/50 td.gantt-freeze-actions,
table.gantt-table tr.bg-muted\/50 th.gantt-freeze-actions {
  background: hsl(var(--muted) / 0.5) !important;
}

table.gantt-table tr.bg-muted\/50 td.gantt-freeze-no,
table.gantt-table tr.bg-muted\/50 th.gantt-freeze-no {
  background: hsl(var(--muted) / 0.5) !important;
}

table.gantt-table tr.bg-muted\/50 td.gantt-freeze-mayor,
table.gantt-table tr.bg-muted\/50 th.gantt-freeze-mayor {
  background: hsl(var(--muted) / 0.5) !important;
}

table.gantt-table tr.bg-muted\/50 td.gantt-freeze-importe,
table.gantt-table tr.bg-muted\/50 th.gantt-freeze-importe {
  background: hsl(var(--muted) / 0.5) !important;
}

table.gantt-table tr.bg-muted\/50 td.gantt-freeze-pct,
table.gantt-table tr.bg-muted\/50 th.gantt-freeze-pct {
  background: hsl(var(--muted) / 0.5) !important;
}

/* Red background rows (discount lines) */
table.gantt-table tr.bg-red-50\/50 td.gantt-freeze-actions {
  background: hsl(var(--destructive) / 0.1) !important;
}

table.gantt-table tr.bg-red-50\/50 td.gantt-freeze-no {
  background: hsl(var(--destructive) / 0.1) !important;
}

table.gantt-table tr.bg-red-50\/50 td.gantt-freeze-mayor {
  background: hsl(var(--destructive) / 0.1) !important;
}

table.gantt-table tr.bg-red-50\/50 td.gantt-freeze-importe {
  background: hsl(var(--destructive) / 0.1) !important;
}

table.gantt-table tr.bg-red-50\/50 td.gantt-freeze-pct {
  background: hsl(var(--destructive) / 0.1) !important;
}

/* Primary background rows (total lines) */
table.gantt-table tr.bg-primary\/10 td.gantt-freeze-actions {
  background: hsl(var(--primary) / 0.1) !important;
}

table.gantt-table tr.bg-primary\/10 td.gantt-freeze-no {
  background: hsl(var(--primary) / 0.1) !important;
}

table.gantt-table tr.bg-primary\/10 td.gantt-freeze-mayor {
  background: hsl(var(--primary) / 0.1) !important;
}

table.gantt-table tr.bg-primary\/10 td.gantt-freeze-importe {
  background: hsl(var(--primary) / 0.1) !important;
}

table.gantt-table tr.bg-primary\/10 td.gantt-freeze-pct {
  background: hsl(var(--primary) / 0.1) !important;
}